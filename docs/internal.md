## Внутреннее устройство

### Терминология

 - Sexpr - Symbolic expression (символьное выражение). Это определяющий тип данных (и тип выражений) для Лисп системы. Фактически представляет собой динамический тип данных. Главная особенность Sexpr в том, что оно может быть либо так называемой "точечной парой", содержащей в себе два других Sexpr, либо "атомом", т.е. всем тем, что НЕ является точечной парой, в форме Бэкуса-Наура это выглядит так:

 ```
    <Sexpr> ::= <Atom> | <Cons>
    <Cons> ::= (<Sexpr> . <Sexpr>)
    <Atom> ::= <Number> | <Symbol> | <String> | ... (другие типы)
    ... (далее определение сущностей <Number>, <Symbol>, <String>, ... и пр.)
 ```
    
   Внутри себя Sexpr содержит:
    - некоторый числовой индентификатор, показывающий какой тип данных содержит в себе объект
    - сами данные (если это простой тип, например число), либо указатель на сложную структуру представляющую данные

 - PSexpr - "умный указатель" на Sexpr (активно используемый в системе тип), определяется как shared_ptr<Sexpr>

 - Nil - пустой список, является одновременно и атомом и списком (но не Cons-ячейкой)

 - Atom - всё, кроме Cons (не пустых списков), т.е. всё что не является списком, плюс пустой список, он же - Nil.

 - Cons - не пустой список, представлен так называемой Cons-ячейкой (Cell), он же "точечная пара"

 - Cons-ячейка (Cell) - структура, содержащая два Sexpr (внутренняя структура реализующая Cons). Первый элемент (левый Sexpr в "точечной паре") называется "car", второй элемент (правый Sexpr в точечной паре) называется "cdr" (названия закрепились, по историческим причинам и когда-то означали следующее: CAR - "Contents of the Address part of the Register", CDR - "Contents of the Decrement part of the Register")

 - Функциональное значение - один из конкретных вариантов значений Sexpr, реализуется классом Function. Конкретный функционал, который активизируется при вызове функции реализуется наследником класса LispFunction (экземпляр наследника содержится в одном из полей Function).

### Структура проекта

 - base - базовые типы, классы и прочее обязательные для включения в описание всех сущностей системы

 - interfaces - описательная часть (интерфейс) основных классов системы

    - core - интерфейс ядра системы, представляет зависимости основновных классов системы

        - evaluator - содержит IEvaluator и другие интерфейсы сущностей составляющих интерпретатор 

 - implements - реализует заданные интерфейсы (в основном)
    
    - core - реализация ядра, основного функционала системы

        - evaluator - класс Evaluator и др. классы реализующие интерпретатор системы

 - utils - утилиты общего назначения (сюда выделяется код утилит, для упрощения кода классов Лисп-системы)

### Классы

- DIBuilder - фабрика классов

- LispEngine - фасад системы

- Repl - реализует цикл чтения-вычисления печати (Read Eval Print Loop)

- Reader - класс реализующий чтение текста программы и перевод его во внутренние структуры

- Классы в data-structs.h - базовые классы Лисп системы (такие как Sexpr, Cons-ячейки, Function, Number и прочее)

- Evaluator - интерпретатор символьных выражений

- CallResult - представляет результат вычисления Sexpr

- Printer - печатает символьные выражения (Symbol Experesions), т.е. переводит их в текст соглассно определённому представлению и выводит в консоль

- Scope - класс, представляющий область поиска (пространство имён), связанных с символами значений (в этом интерпретаторе, согласно идеологии Common Lisp'a, используются отдельные пространства имён: для функциональных значений связанных с символом и для всех остальных, любых значений)

- RunContext - класс инкапсулирующий информацию о времени выполнения и соотв. объекты (например экземпляр Evaluator), для влияния на контекст выполнения

- Классы в program-structs.h 

   - MemoryManager - класс управляющий ячейками памяти Cons (на данный момент главная его ф-ия, далее планируется максимум операций с памятью перенести в этот класс)

   - LispFunction - базовый класс, для классов в которых реализуется логика работы базовых лисп-операторов

   - Program - класс, в котором хранится информация о текущей выполняемой программе (главная часть текущего контекста выполнения)

   - ProgramContext - класс, экземпляры которого представляют собой части объектов Program и инкапсулируют в себе пространства имён (Scope'ы) для функциональных значений и всех остальных (на данный момент, далее туда планируются помещать другие сущности, связанные с моментом выполнения)

   - ... (некоторые другие)

- Классы в BaseFunctions.h (позже base-functions.h) - наследники LispFunction, реализующие логику базовых операторов и ф-ий Лисп-системы

- Global - класс, являющийся базовым компонентом (находится в директории base), необходим для инкапсуляции основных классов, к которым должен иметь доступ любой компонент системы (например, к контексу выполнения и фабрики классов)

